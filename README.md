# TrackAd Symfony Project

## Описание

Проект представляет собой простое Symfony приложение, предназначенное для демонстрации процесса сборки и деплоя с использованием Docker, Docker Compose и Kubernetes через Helm.

# Важно

В рамках тестового задания используется встроенный сервер PHP, что позволяет упростить деплой и демонстрацию (в ТЗ нет требования для  продового решения всей инфраструктуры приложения).

В production окружении лучше использовать связку Nginx+php-fpm для лучшей производительности, безопасности и масштабируемости.

Так же, хочу заметить, что впервые ознакомился с приложениями на базе Symfony. В связи с этим сам проект можно считать далеко неидеальным.

## Развертывание проекта

### 1. Локальное развертывание с Docker Compose

1. **Клонирование репозитория:**

   ```bash
   git clone <репозиторий>
   cd trackad-task
   ```

2. **Сборка и запуск с Docker Compose:**

   Используйте Docker Compose для сборки и запуска приложения локально.

   ```bash
   docker-compose up --build
   ```

   Это запустит приложение, доступное по адресу `http://localhost:8080`.

3. **Изменение переменных:**

   Вы можете изменить порт, на котором приложение будет доступно, отредактировав файл `docker-compose.yml`:

   ```yaml
   ports:
     - "8080:8000"
   ```

### 2. Развертывание через Docker

1. **Сборка Docker образа:**

   Выполните следующую команду для сборки Docker образа:

   ```bash
   docker build -t trackad-task-app:latest -f docker/app.prod.Dockerfile .
   ```

2. **Запуск Docker контейнера:**

   Для запуска контейнера выполните:

   ```bash
   docker run -p 8080:8000 trackad-task-app:latest
   ```

   Приложение будет доступно по адресу `http://localhost:8080`.

### 3. Деплой в Kubernetes с Helm

 **Деплой с помощью Helm:**

   Используйте следующую команду для деплоя приложения в Kubernetes:

   ```bash
   helm upgrade --install trackad-task helm/trackad-task --set image.tag=latest
   ```

### Параметры конфигурации

- **`applicationPort`**:
  - **Описание**: Устанавливает порт, на котором доступно приложение внутри пода.
  - **Тип**: целое число
  - **По умолчанию**: `8000`

- **`replicaCount`**:
  - **Описание**: Указывает количество реплик приложения, которые будут развернуты.
  - **Тип**: целое число
  - **По умолчанию**: `1`

- **`image.repository`**:
  - **Описание**: Задает репозиторий Docker образа, который будет использоваться для развертывания.
  - **Тип**: строка
  - **По умолчанию**: `trackad-task-app`

- **`image.tag`**:
  - **Описание**: Указывает тег Docker образа.
  - **Тип**: строка
  - **По умолчанию**: `latest`

- **`image.pullPolicy`**:
  - **Описание**: Определяет политику извлечения образа Docker.
  - **Тип**: строка
  - **По умолчанию**: `IfNotPresent`

### Настройки сервиса

- **`service.type`**:
  - **Описание**: Определяет тип сервиса Kubernetes, используемого для доступности приложения.
  - **Тип**: строка
  - **По умолчанию**: `NodePort`

- **`service.port`**:
  - **Описание**: Указывает порт, на котором сервис будет слушать внутри кластера Kubernetes.
  - **Тип**: целое число
  - **По умолчанию**: `8000`

- **`service.nodePort`**:
  - **Описание**: Определяет порт, на котором сервис будет доступен за пределами кластера. На ноде будет открыт данный порт.
  - **Тип**: целое число
  - **По умолчанию**: `30080`

### Управление ресурсами

- **`resources`**:
  - **Описание**: Позволяет определить ограничения ресурсов, таких как CPU и память, для контейнера.
  - **Тип**: объект
  - **По умолчанию**: `{}` (без ограничений)
